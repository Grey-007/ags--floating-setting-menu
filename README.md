# AGS v3 Refresh Menu - Modern Architecture
> ### ** No updates for next few months - still in development - its on pause for now **
**Pure AGS v3** - No deprecated APIs. Self-registering windows. Pre-compiled styles.

## Quick Start

```bash
./install.sh  # Installs to ~/.config/ags and builds CSS
ags           # Start AGS
```

Menu appears at bottom-right corner.

## What's Different (AGS v3 Modern)

This uses the **latest AGS v3 architecture**:

âœ… **No `App.config()`** - Windows self-register when imported
âœ… **Modern imports** - `import { Widget } from "ags"`
âœ… **Pre-compiled CSS** - No runtime SCSS compilation
âœ… **snake_case properties** - `class_name`, `on_clicked`
âœ… **TypeScript support** - .ts files (works with .js too)
âœ… **Modular design** - Easy to add bars, launchers, etc.

## File Structure

```
~/.config/ags/
â”œâ”€â”€ app.ts                      â† Entry point (imports windows)
â”œâ”€â”€ build.sh                    â† Compiles SCSS to CSS
â”œâ”€â”€ tsconfig.json               â† TypeScript config
â”œâ”€â”€ style/
â”‚   â”œâ”€â”€ style.scss              â† Source styles
â”‚   â””â”€â”€ style.css               â† Compiled (generated by build.sh)
â””â”€â”€ widgets/
    â””â”€â”€ refreshMenu/
        â”œâ”€â”€ window.ts           â† Main window (self-registers)
        â”œâ”€â”€ components/
        â”‚   â””â”€â”€ section.ts      â† Reusable section
        â”œâ”€â”€ sections/
        â”‚   â”œâ”€â”€ refreshApps.ts  â† Refresh apps section
        â”‚   â””â”€â”€ comingSoon.ts   â† Placeholder sections
        â””â”€â”€ utils/
            â””â”€â”€ commands.ts     â† Command registry
```

## Requirements

```bash
# AGS v3
yay -S aylurs-gtk-shell

# SASS compiler
sudo pacman -S sassc

# Nerd Fonts
yay -S ttf-nerd-fonts-symbols-mono
```

## Installation

### Automated

```bash
chmod +x install.sh
./install.sh
```

### Manual

```bash
# Copy files
cp -r * ~/.config/ags/

# Build CSS
cd ~/.config/ags
./build.sh

# Start AGS
ags
```

## Usage

**Open:** Click circular button at bottom-right
**Refresh app:** Click any app button
**Close:** Click button again or click outside

## Development Workflow

### After Editing Code

```bash
ags quit
ags
```

### After Editing Styles

```bash
cd ~/.config/ags
./build.sh
ags quit
ags
```

## Adding More Windows

AGS v3 makes this trivial:

### 1. Create Window File

**`widgets/bar/window.ts`:**
```typescript
import { Widget } from "ags";

const Bar = Widget.Window({
    name: "bar",
    anchor: ["top", "left", "right"],
    child: Widget.Box({
        children: [
            Widget.Label({ label: "My Bar" }),
        ],
    }),
});
```

### 2. Import in app.ts

**`app.ts`:**
```typescript
import "ags/style/style.css";
import "./widgets/refreshMenu/window.js";
import "./widgets/bar/window.js";  // â† Add this line
```

### 3. Restart

```bash
ags quit
ags
```

Done! No configuration, no exports, no manual registration.

## Adding Commands

Edit `widgets/refreshMenu/utils/commands.ts`:

```typescript
export const commands = {
    // ... existing
    
    myApp: {
        label: "My App",
        icon: "",
        execute: async () => {
            await Utils.execAsync(['pkill', 'myapp']);
            return { success: true, message: "Restarted" };
        }
    },
};
```

Restart AGS to see the new button.

## Adding Sections

1. Create `widgets/refreshMenu/sections/mySection.ts`
2. Import in `widgets/refreshMenu/window.ts`
3. Add to DrawerPanel children array

See `MIGRATION_GUIDE.md` for detailed examples.

## Styling

Edit `style/style.scss`:

```scss
* {
    --primary: #89b4fa;     // Change accent color
    --surface: #1e1e2e;     // Change background
    // ...
}
```

Then rebuild:

```bash
./build.sh
ags quit && ags
```

## Modern AGS v3 Patterns

### Window Creation (Self-Registering)

```typescript
// Old (v1/v2)
export function MyWindow() {
    return Widget.Window({ ... });
}

// New (v3)
const MyWindow = Widget.Window({ ... });
// That's it! Auto-registers, no export needed
```

### Imports

```typescript
// Old
import Widget from "resource:///com/github/Aylur/ags/widget.js";

// New
import { Widget, Variable, Utils, App } from "ags";
```

### Properties

```typescript
// Old
Widget.Button({
    className: "my-class",
    onClicked: () => {},
})

// New
Widget.Button({
    class_name: "my-class",
    on_clicked: () => {},
})
```

### No App.config()

```typescript
// Old
App.config({
    windows: [MyWindow()],
    style: css,
});

// New
// Just import windows and CSS in app.ts
import "ags/style/style.css";
import "./widgets/myWindow/window.js";
```

## Troubleshooting

### CSS not found

**Run build script:**
```bash
./build.sh
```

### Window not appearing

**Check AGS output:**
```bash
ags  # Look for errors
```

**Verify window is imported:**
```typescript
// In app.ts
import "./widgets/refreshMenu/window.js";
```

### Icons show as boxes

**Install Nerd Fonts:**
```bash
yay -S ttf-nerd-fonts-symbols-mono
# Logout/login
```

### Property errors

**Use snake_case:**
```typescript
class_name: "...",     // Not className
on_clicked: () => {},  // Not onClicked
```

## Documentation

- **MIGRATION_GUIDE.md** - Complete v3 migration reference
- **AGS Docs:** https://aylur.github.io/ags-docs/

## Commands Reference

```bash
# Build CSS
./build.sh

# Start AGS
ags

# Restart AGS
ags quit && ags

# Auto-start (hyprland.conf)
exec-once = ags
```

## Features

âœ… Modern AGS v3 API only
âœ… Self-registering windows
âœ… TypeScript support
âœ… Pre-compiled styles
âœ… Smooth GTK animations
âœ… Click-outside dismiss
âœ… Loading states
âœ… Modular architecture
âœ… Production-ready

## Architecture Highlights

**No deprecated patterns** - Uses only current AGS v3 API

**Self-registration** - Windows register automatically when created

**Pre-compilation** - CSS built before runtime (faster startup)

**Modular** - Add windows by importing them in app.ts

**Type-safe** - TypeScript support (works with JS too)

---

**Ready to use!** This is the modern way to build AGS configs. ðŸš€
